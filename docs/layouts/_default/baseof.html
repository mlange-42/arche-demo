<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{{ or .Title .Site.Title }}{{ if ne .Kind "home" }} | {{ .CurrentSection.Title }}{{ end }}</title>

    {{ range .Site.Params.custom_css -}}
    <link rel="stylesheet" href="{{ . | absURL }}">
    {{- end }}

    {{ range .Site.Params.custom_js -}}
    <script src="{{ . | absURL }}"></script>
    {{- end }}

    {{ if .Page.Param "wasm" }}
    {{ $url := ( printf "%swasm/%s.wasm" .Site.BaseURL .Page.Params.wasm ) }}
    <script>
        if (!WebAssembly.instantiateStreaming) {
            WebAssembly.instantiateStreaming = async (resp, importObject) => {
                const source = await (await resp).arrayBuffer();
                return await WebAssembly.instantiate(source, importObject);
            };
        }

        const go = new Go();
        WebAssembly.instantiateStreaming(fetch({{ $url }}), go.importObject).then(res => {
            go.run(res.instance)
        })
    </script>
    {{- end }}
</head>

<body>
    {{ block "page" . }}{{ end }}
</body>

</html>